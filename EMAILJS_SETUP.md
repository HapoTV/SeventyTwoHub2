# EmailJS Setup Guide for Admin Status Updates - SeventyTwo Hub

This guide will help you set up a **separate EmailJS service** specifically for admin status update emails when admins approve, reject, or update business registration applications.

**Important**: This is a dedicated EmailJS service for admin status updates only. Your existing EmailJS configuration for user confirmation emails and admin notification emails will remain unchanged.

## Prerequisites

- New EmailJS account (separate from existing one) or additional service in existing account
- Email service provider (Gmail, Outlook, etc.)

## Step 1: Create Dedicated EmailJS Service for Admin Status Updates

1. Go to https://www.emailjs.com/ and either:
   - Create a new account for admin status emails, OR
   - Use your existing account and create a new service
2. Go to the **Email Services** section
3. Click **Add New Service** and choose your email provider (e.g., Gmail)
4. Name this service something like "Admin Status Updates" to distinguish it
5. Follow the setup instructions for your email provider
6. Note down your **Admin Service ID** (e.g., `service_admin_abc123`)

## Step 2: Create Single Universal Email Template

You only need **ONE EmailJS template** that works for all 4 status types (Approve, Reject, Need Docs, Under Review). The application generates the complete HTML content for each email type.

1. Go to the **Email Templates** section in EmailJS
2. Click **Create New Template**
3. Name it "Universal Status Update Template"
4. Use this simple universal template:

### Template Settings:
- **Template Name**: `Universal Status Update Template`
- **Subject**: `{{subject}}`
- **Content**: Use HTML format and paste the following:

```html
{{{html_content}}}
```

**That's it!** This single template receives the complete HTML email (including styling, headers, footers) from your application.

### How It Works:
- **Application generates**: Complete HTML email with styling for each status type
- **EmailJS template**: Simply displays the HTML content received
- **All 4 status emails**: Use the same template ID but different HTML content

### Template Variables Used:
- `{{to_email}}` - Recipient email address (EmailJS auto-fills this)
- `{{subject}}` - Email subject line (generated by application)
- `{{{html_content}}}` - Complete HTML email (generated by application)

**Note**: The other variables (`{{business_name}}`, `{{reference_number}}`, etc.) are embedded within the `html_content`, not as separate template variables.

4. Save the template and note down your **Template ID** (e.g., `template_xyz789`)
   - This same template ID will be used for all 4 status types

## Step 3: Get Admin Public Key

1. Go to **Account** settings in EmailJS
2. Find your **Public Key** for this account/service (e.g., `user_admin_abcdef123456`)

## Step 4: Configure Environment Variables

Create or update your `.env` file in the project root with the following **ADMIN-SPECIFIC** variables:

```env
# Admin Status Update EmailJS Configuration (separate from existing EmailJS)
REACT_APP_ADMIN_EMAILJS_SERVICE_ID=your_admin_service_id_here
REACT_APP_ADMIN_EMAILJS_TEMPLATE_ID=your_admin_template_id_here  
REACT_APP_ADMIN_EMAILJS_PUBLIC_KEY=your_admin_public_key_here

# Your existing EmailJS configuration remains unchanged:
# REACT_APP_EMAILJS_SERVICE_ID=your_existing_service_id
# REACT_APP_EMAILJS_TEMPLATE_ID=your_existing_template_id
# REACT_APP_EMAILJS_PUBLIC_KEY=your_existing_public_key
```

Replace the placeholder values with your actual **ADMIN** EmailJS credentials:
- `your_admin_service_id_here` → Your Admin EmailJS Service ID
- `your_admin_template_id_here` → Your Admin EmailJS Template ID  
- `your_admin_public_key_here` → Your Admin EmailJS Public Key

## Step 5: Test the Integration

1. Start your development server: `npm run dev`
2. Navigate to the admin dashboard
3. Find a business registration with "pending" status
4. Click the **Review** button to open the modal
5. Add some review notes
6. Click one of the status buttons (Approve, Reject, Need Docs, Under Review)
7. Check that:
   - The status updates in the database
   - An email is sent to the business owner
   - The admin receives confirmation of the email being sent

## Email Templates Included

The system includes 4 pre-designed HTML email templates:

### 1. Approval Email (`approved`)
- Green color scheme with celebration theme
- Includes welcome message and next steps
- Shows application details and admin notes

### 2. Rejection Email (`rejected`)
- Professional red color scheme
- Explains the decision with admin feedback
- Encourages reapplication after addressing issues

### 3. Under Review Email (`under_review`)
- Blue color scheme indicating progress
- Sets expectations for review timeline
- Includes current status and next steps

### 4. Need Documents Email (`requires_documents`)
- Yellow/orange color scheme for urgency
- Lists required documents from admin notes
- Provides clear action items for the applicant

## Troubleshooting

### Common Issues:

1. **Email not sending**
   - Check that all environment variables are set correctly
   - Verify EmailJS service is active and properly configured
   - Check browser console for error messages

2. **Template variables not working**
   - Ensure template uses exact variable names: `{{variable_name}}`
   - For HTML content, use triple braces: `{{{html_content}}}`
   - Check that all required variables are included in the template

3. **Emails going to spam**
   - Configure SPF, DKIM, and DMARC records for your domain
   - Use a verified email address as the sender
   - Avoid spam trigger words in subject lines

4. **Rate limiting**
   - EmailJS has rate limits on free accounts
   - Consider upgrading to a paid plan for higher limits
   - Implement retry logic for failed sends

### Testing Tips:

- Use your own email address for initial testing
- Check both inbox and spam folders
- Test all 4 status types (approve, reject, under review, need docs)
- Verify that admin notes appear correctly in emails
- Test with different business registration data

## Security Notes

- Never commit your actual EmailJS credentials to version control
- Use environment variables for all sensitive configuration
- Consider implementing additional email validation
- Monitor EmailJS usage to prevent abuse

## Support

If you encounter issues:
1. Check the EmailJS dashboard for delivery status
2. Review browser console logs for JavaScript errors
3. Verify all configuration steps were completed
4. Test with a simple email first before using complex templates

For EmailJS-specific issues, refer to their documentation: https://www.emailjs.com/docs/
